<!-- Mint NFT Page -->

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <%- include("partials/head") %>

  <script src="/scripts/bundles/mint-bundle.js"></script>

  <body onload="onPageLoad()">
    <!-- Navbar -->

    <%- include("partials/navbar") %>

    <!-- Mint Section -->

    <section id="mintNFT">

      <div id="popup" class="popup-position" style="background-color: rgba(0,0,0,0.7); display: none; position: fixed; height:100%; width:100%; z-index:1000; align-items: center; justify-content: center;">
        <%- include("partials/modal") %>
      </div>

      <div class="container-fluid">
        <div class="row">
          <div class="col-4 image-container"></div>

          <div class="col-8 form-container">
            <h1 class="mint-header">Emissão de NFT</h1>

            <form id="form" action="" method="POST" class="validated-form" onsubmit="mintNFT()">
              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-user fa-lg"></i>
                  <input type="text" name="username" id="username" class="form-control" required />
                </div>
                <label class="form-label" for="username">Insira o username de destino</label>
              </div>

              <!-- <hr>

                        <div class="flex-fill">
                            <div class="mint-data">
                                <i class="fas fa-tree fa-lg"></i>
                                <input type="text" name="nftId" id="nftId" class="form-control" required/>
                            </div>
                            <label class="form-label" for="nftId">Insira o Id do NFT (único)</label>
                        </div> -->

              <!-- <hr>

                        <div class="d-flex flex-column align-items-start">
                            <div class="mint-data">
                                <i class="fa-solid fa-coins"></i>
                                <input type="number" required name="amount" id="amount" min="1" value="1" step="1">
                            </div>
                            <label class="form-label" for="amount">Insira o valor a ser adicionado no NFT</label>
                        </div> -->

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-user fa-lg"></i>
                  <input type="text" name="landOwner" id="landOwner" class="form-control" required />
                </div>
                <label class="form-label" for="landOwner">Insira o nome do proprietário da terra</label>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-user fa-lg"></i>
                  <input type="text" name="compensationOwner" id="compensationOwner" class="form-control" required />
                </div>
                <label class="form-label" for="compensationOwner">Insira o nome do proprietário dos direitos de compensação</label>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fa-solid fa-id-card"></i>
                  <input type="text" name="cpf" id="cpf" class="form-control" required />
                </div>
                <label class="form-label" for="cpf">Insira o CPF do proprietário</label>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-book fa-lg"></i>
                  <input type="text" name="car" id="car" class="form-control" required />
                </div>
                <div style="display: flex; gap: 16px;">
                <label class="form-label" for="car">Insira o CAR (Certificado Ambiental Rural)</label>
                <div id="alert-display" style="display: none">
                  <a id="alert-link" class="d-inline-block" data-bs-toggle="tooltip" style="text-decoration: none;" title="Esse CAR possui alertas! Clique para ver mais." target="_blank">
                    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 122.89 111.55"><defs><style>.cls-1{fill:#b71616;}.cls-2{fill:#e21b1b;fill-rule:evenodd;}.cls-3{fill:#fff;}</style></defs><title>Esse CAR possui alertas! Clique para ver mais.</title><path class="cls-1" d="M2.35,84.43,45.29,10.2l.17-.27h0a22.92,22.92,0,0,1,7-7.23A17,17,0,0,1,61.58,0a16.78,16.78,0,0,1,9.11,2.69,22.79,22.79,0,0,1,7,7.26c.13.21.25.42.36.64l42.24,73.34.23.44h0a22.22,22.22,0,0,1,2.37,10.19,17.59,17.59,0,0,1-2.16,8.35,16,16,0,0,1-6.94,6.61l-.58.26a21.34,21.34,0,0,1-9.11,1.74v0H17.62c-.23,0-.44,0-.66,0a18.07,18.07,0,0,1-6.2-1.15A16.46,16.46,0,0,1,3,104.26a17.59,17.59,0,0,1-3-9.58,23,23,0,0,1,1.57-8.74,8.24,8.24,0,0,1,.77-1.51Z"/><path class="cls-2" d="M9,88.76l43.15-74.6c5.23-8.25,13.53-8.46,18.87,0l42.44,73.7c3.38,6.81,1.7,16-9.34,15.77H17.62c-7.27.18-12-6.19-8.64-14.87Z"/><path class="cls-3" d="M57.57,82.7a5.51,5.51,0,0,1,3.48-1.58,5.75,5.75,0,0,1,2.4.35,5.82,5.82,0,0,1,2,1.31,5.53,5.53,0,0,1,1.62,3.55,6.05,6.05,0,0,1-.08,1.4,5.54,5.54,0,0,1-5.64,4.6,5.67,5.67,0,0,1-2.27-.52,5.56,5.56,0,0,1-2.82-2.94,5.65,5.65,0,0,1-.35-1.27,5.83,5.83,0,0,1-.06-1.31h0a6.19,6.19,0,0,1,.57-2,4.57,4.57,0,0,1,1.13-1.56Zm8.16-10.24c-.2,4.79-8.31,4.8-8.5,0-.82-8.21-2.92-29.39-2.85-37.1.07-2.38,2-3.79,4.56-4.33a12.83,12.83,0,0,1,5,0c2.61.56,4.65,2,4.65,4.44v.24L65.73,72.46Z"/></svg>
                    Alerts
                   </a>
                </div>
              </div>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-leaf fa-lg"></i>
                  <input type="text" name="phyto" id="phyto" class="form-control" required />
                </div>
                <label class="form-label" for="phyto">Insira o bioma da área</label>
              </div>
              
              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fa-solid fa-mountain-sun"></i>
                  <input type="text" name="basin" id="basin" class="form-control" required />
                </div>
                <label class="form-label" for="basin">Insira a bacia da área</label>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fa-solid fa-chart-area fa-lg"></i>
                  <input type="text" name="area" id="area" class="form-control" required />
                </div>
                <label class="form-label" for="area">Insira o tamanho da propriedade (hectares)</label>
              </div>

              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-location-dot fa-lg"></i>
                  <input type="text" name="location" id="location" class="form-control" required />
                </div>
                <label class="form-label" for="location">Insira localização da área</label>
              </div>

              <div class="flex-fill">
                <div class="mint-data" id="display-cert" style="display: none;">
                  <i class="fa fa-download fa-lg"></i>
                  <a id="cert" >Download Certificate</a>
                </div>
              </div>
              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-coins fa-lg"></i>
                  <fieldset onchange="hideMintRate()" >
                    <legend>Pode emitir C21 :</legend>
                    <div class="input-radio-container">
                      <div>
                        <input type="radio" name="mintSylvas" id="mintSylvasAtivo" value="Ativo" checked>
                        <label class="input-radio-label" for="mintSylvas">Ativo</label>
                      </div>
                      <div>
                        <input type="radio"  name="mintSylvas" id="mintSylvasInativo" value="Inativo">
                        <label class="input-radio-label" for="mintSylvas">Inativo</label>
                      </div>
                    </div>
                  </fieldset>

                </div>
              </div>   

              <div id="divMintRate">
              <hr />              

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-percent fa-lg"></i>
                  <fieldset>
                    <legend>Potencial de geração de C21s:</legend>
                    <div>
                      <input type="range" id="mintRate" name="mintRate" min="0" max="100" value="100" onchange="updMintRateSpan()">
                      <span id="spanMintRate">x</span>
                    </div>                    
                  </fieldset>
                </div>
              </div>          
            </div>
              <hr />

              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-magnifying-glass-chart fa-lg"></i>
                  <fieldset>
                    <legend>Tipo do NFT:</legend>
                    <div class="input-radio-container">
                      <div>
                        <input type="radio" id="nftType" name="nftType" value="reflorestamento" checked>
                        <label class="input-radio-label" for="reflorestamento">Reflorestamento</label>
                      </div>
                      <div>
                        <input type="radio" id="nftType" name="nftType" value="corte">
                        <label class="input-radio-label" for="corte">Corte</label>
                      </div>
                      <div>
                        <input type="radio" id="nftType" name="nftType" value="reserva">
                        <label class="input-radio-label" for="corte">Reserva legal de compensação</label>
                      </div>
                    </div>
                  </fieldset>

                </div>
              </div>        

 

              <hr />  
              <div id="userNotes-show"></div>
              <div class="flex-fill">
                <div class="mint-data">
                  <i class="fas fa-marker fa-lg"></i>
                  <textarea name="customNotes" id="customNotes" class="form-control" rows="4" cols="50"></textarea>
                </div>
                <label for="customNotes">Notas:</label>
              </div>
              
              <img id="loader" class="loading-icon" src="../images/loader.gif" style="margin: auto" />
              <div hidden id="signing-files" style="text-align: center">
                <p><strong>Faça o upload da sua chave privada</strong></p>
                <input type="file" id="private-key" name="filename" style="margin-left: 50px" /><br /><br />
                <p id="download-cert"><strong>Faça o upload do seu certificado</strong></p>
                <input type="file" id="certificate" name="filename" style="margin-left: 50px" /><br /><br />
              </div>
              <div class="buttons">
                <div class="mint-button pb-5">
                  <button id="submitButton" type="submit" style="display: flex" class="btn btn-primary btn-md">Enviar Transação</button>
                </div>
                <div class="mint-button pb-5">
                  <button id="declineButton" onclick='responseRequest("rejected")' style="display: flex" class="btn btn-dark btn-md">Rejeitar</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </body>
</html>

<script> 

function hideMintRate(){
  divMintRate =  document.getElementById("divMintRate");
  mintSylvas = document.querySelector("input[name='mintSylvas']:checked").value;
  if (mintSylvas === "Ativo") {
    divMintRate.style.display = "flex";
  } else {
    divMintRate.style.display = "none";
  }
}  

function updMintRateSpan(){
  mintRate =  document.getElementById("mintRate").value;
  txtMintRate = document.getElementById("spanMintRate");
  txtMintRate.textContent = mintRate; 
}

function onPageLoad(){
  mintRate =  document.getElementById("mintRate").value;
  txtMintRate = document.getElementById("spanMintRate");
  txtMintRate.textContent = mintRate;
  if ("<%= requestId %>") {
    console.log('tem id');
    getRequest("<%= requestId %>")
    document.getElementById("display-cert").style.display = "block";
  }
}
</script>